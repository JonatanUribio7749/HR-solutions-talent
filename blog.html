<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>HR Solutions & Talent - Desarrollando el Potencial Humano</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="img/about.jpg" rel="icon">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/all.min.css" rel="stylesheet">
  <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <link href="css/style.css" rel="stylesheet">

  <style>
    /* --- tu mismo estilo visual original --- */
    .page-header-custom {
      background: linear-gradient(90deg,#1c4b6a 0%,#2e81aa 60%,rgba(224,186,14,0.705) 100%);
      height: 220px; position: relative;
    }
    .header-logo img { height: 180px; animation: fadeInUp 1.2s ease-in-out; }
    .header-text h1 { font-size: 2.8rem; animation: fadeInRight 1.2s ease-in-out; }
    @keyframes fadeInUp {from{transform:translateY(20px);opacity:0;}to{transform:translateY(0);opacity:1;}}
    @keyframes fadeInRight {from{transform:translateX(20px);opacity:0;}to{transform:translateX(0);opacity:1;}}
    .whatsapp-float {position:fixed;bottom:20px;left:20px;background-color:#25d366;color:white;border-radius:50%;width:60px;height:60px;font-size:28px;
      display:flex;align-items:center;justify-content:center;box-shadow:2px 2px 10px rgba(0,0,0,0.3);z-index:999;transition:transform 0.3s ease;}
    .whatsapp-float:hover {transform:scale(1.1);background-color:#20b858;}
    .lds-ellipsis {display:inline-block;position:relative;width:80px;height:20px;}
    .lds-ellipsis div{position:absolute;top:6px;width:13px;height:13px;border-radius:50%;background:#f4c10f;animation-timing-function:cubic-bezier(0,1,1,0);}
    .lds-ellipsis div:nth-child(1){left:8px;animation:lds-ellipsis1 0.6s infinite;}
    .lds-ellipsis div:nth-child(2){left:8px;animation:lds-ellipsis2 0.6s infinite;}
    .lds-ellipsis div:nth-child(3){left:32px;animation:lds-ellipsis2 0.6s infinite;}
    .lds-ellipsis div:nth-child(4){left:56px;animation:lds-ellipsis3 0.6s infinite;}
    @keyframes lds-ellipsis1{0%{transform:scale(0);}100%{transform:scale(1);}}
    @keyframes lds-ellipsis2{0%{transform:translateX(0);}100%{transform:translateX(24px);}}
    @keyframes lds-ellipsis3{0%{transform:scale(1);}100%{transform:scale(0);}}
  </style>
</head>

<body>
  <!-- Navbar -->
  <div class="container-fluid nav-bar p-0">
    <div class="container-lg p-0">
      <nav class="navbar navbar-expand-lg bg-secondary navbar-dark">
        <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-between" id="navbarCollapse">
          <div class="navbar-nav ml-auto py-0">
            <a href="index.html" class="nav-item nav-link">Inicio</a>
            <a href="about.html" class="nav-item nav-link">Nosotros</a>
            <a href="service.html" class="nav-item nav-link">Servicios</a>
            <a href="pricing.html" class="nav-item nav-link">Clientes</a>
            <a href="contact.html" class="nav-item nav-link">Contacto</a>
            <a href="blog.html" class="nav-item nav-link active">Búsquedas</a>
          </div>
        </div>
      </nav>
    </div>
  </div>

  <!-- Encabezado -->
  <div class="container-fluid page-header-custom d-flex align-items-center justify-content-between px-5">
    <div class="header-logo">
      <img src="img/hr_s_logo-transparente.png" alt="HR Solutions & Talent" class="img-fluid">
    </div>
    <div class="header-text text-left">
      <h1 class="text-white font-weight-bold mb-1">Búsquedas</h1>
    </div>
  </div>

  <!-- Sección de búsquedas -->
  <div class="container py-5" id="contenedor-busquedas">
    <div class="text-center mb-5" data-aos="fade-down">
      <small class="bg-warning text-dark text-uppercase font-weight-bold px-2 py-1 rounded">Oportunidades Laborales</small>
      <h1 class="mt-3 font-weight-bold">Explorá nuestras búsquedas activas</h1>
      <p class="text-muted">Postulate a los puestos que se alineen con tu perfil profesional.</p>
    </div>

    <div id="loader-busquedas" class="text-center my-5">
      <div class="lds-ellipsis"><div></div><div></div><div></div><div></div></div>
      <p class="text-muted mt-3">Cargando puestos laborales para vos...</p>
    </div>

    <div id="lista-busquedas" class="row"></div>
  </div>

  <!-- Modal de postulación -->
  <div class="modal fade" id="applyModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content border-0 shadow">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title font-weight-bold">Postularme</h5>
          <button type="button" class="close text-white" data-dismiss="modal"><span>&times;</span></button>
        </div>

        <form id="applyForm" action="mail/contact.php" method="POST" enctype="multipart/form-data">
          <!-- Honeypot -->
          <input type="text" name="website" style="display:none" tabindex="-1" autocomplete="off">
          <!-- Ocultos completados por JS -->
          <input type="hidden" name="puesto" id="f_puesto">
          <input type="hidden" name="rubro" id="f_rubro">
          <input type="hidden" name="ubicacion" id="f_ubicacion">
          <input type="hidden" name="subject" id="f_subject" value="Nueva Postulación">

          <div class="modal-body">
            <div class="form-group">
              <label>Nombre y Apellido</label>
              <input type="text" name="name" class="form-control" required>
            </div>

            <div class="form-group">
              <label>Email</label>
              <input type="email" name="email" class="form-control" required>
            </div>

            <div class="form-group">
              <label>Mensaje (opcional)</label>
              <textarea name="message" rows="3" class="form-control" placeholder="Contanos brevemente tu perfil o disponibilidad"></textarea>
            </div>

            <div class="form-group">
              <label>Adjuntar CV</label>
              <input id="cvFile" type="file" name="cv" class="form-control-file" accept=".pdf,.doc,.docx" required>
              <small class="text-muted">Formatos: PDF, DOC, DOCX (máx. 5 MB)</small>
            </div>
          </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancelar</button>
            <button type="submit" class="btn btn-primary font-weight-bold">Enviar postulación</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="bg-dark text-white pt-5 pb-3">
    <div class="container text-center">
      <img src="img/hr_s_logo-transparente.png" alt="HR Solutions & Talent" style="max-width:180px;" class="mb-3">
      <p class="small mb-0">&copy; 2025 HR Solutions & Talent. Todos los derechos reservados.</p>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
  <script src="lib/easing/easing.min.js"></script>
  <script src="lib/waypoints/waypoints.min.js"></script>
  <script src="lib/owlcarousel/owl.carousel.min.js"></script>
  <script src="js/main.js"></script>

  <!-- WhatsApp -->
  <a href="https://wa.me/5491134549963" class="whatsapp-float" target="_blank">
    <i class="fab fa-whatsapp"></i>
  </a>

  <script>
  // Carga de búsquedas desde Google Sheets (ya funcional)
  const URL_SCRIPT = "https://script.google.com/macros/s/AKfycbwVbKGcFFr_yWQc05DNlLZCXGAIUePtFmFUmOLmfY6R-RRtKqpu9mVhUzLAvNgh4qk/exec";
  fetch(URL_SCRIPT)
    .then(res => res.json())
    .then(data => {
      document.getElementById("loader-busquedas").style.display = "none";
      const container = document.getElementById("lista-busquedas");
      if (!data || !data.length) {
        container.innerHTML = "<p class='text-muted'>No hay búsquedas activas en este momento.</p>";
        return;
      }
      data.forEach(b => {
        container.innerHTML += `
          <div class="col-md-6 col-lg-4 mb-4">
            <div class="border rounded p-4 shadow-sm h-100 d-flex flex-column justify-content-between animate__animated animate__fadeInUp">
              <div>
                <h4 class="text-primary font-weight-bold mb-2">${b.puesto}</h4>
                <p><strong>Rubro:</strong> ${b.rubro}</p>
                <p><strong>Ubicación:</strong> ${b.ubicacion}</p>
                <p class="text-muted mt-2">${b.descripcion}</p>
              </div>
              <button class="btn btn-outline-primary mt-3 font-weight-bold btn-postular"
                      data-puesto="${b.puesto}" data-rubro="${b.rubro}" data-ubicacion="${b.ubicacion}">
                Postularme
              </button>
            </div>
          </div>`;
      });
    })
    .catch(err => {
      console.error("Error al cargar búsquedas:", err);
      document.getElementById("lista-busquedas").innerHTML = "<p class='text-danger'>No se pudieron cargar las búsquedas.</p>";
    });

  // --- Lógica del modal ---
  document.addEventListener('click', e => {
    const btn = e.target.closest('.btn-postular');
    if (!btn) return;
    document.getElementById('f_puesto').value = btn.dataset.puesto;
    document.getElementById('f_rubro').value = btn.dataset.rubro;
    document.getElementById('f_ubicacion').value = btn.dataset.ubicacion;
    document.getElementById('f_subject').value = `Postulación - ${btn.dataset.puesto} (${btn.dataset.ubicacion})`;
    $('#applyModal').modal('show');
  });

  // Validación de tamaño de archivo
  document.getElementById('cvFile')?.addEventListener('change', function() {
    const f = this.files[0];
    if (f && f.size > 5 * 1024 * 1024) {
      alert("El archivo supera los 5 MB. Subí un CV más liviano.");
      this.value = '';
    }
  });

  // Envío nativo (sin fetch)
  document.getElementById('applyForm')?.addEventListener('submit', function() {
    const btn = this.querySelector('button[type="submit"]');
    if (btn) { btn.disabled = true; btn.textContent = "Enviando..."; }
  });
  </script>
</body>
</html>
